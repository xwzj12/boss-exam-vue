webpackJsonp([34],{"5EuC":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),o=a.n(r),n=a("exGp"),s=a.n(n),i={components:{},data:function(){var e=this;return{loading:!1,disableFlag:!1,captcha:"",form:{oldpwd:"",newpwd:"",phone:"",captcha:""},rules:{captcha:[{required:!0,message:"请输入验证码",trigger:"blur"}],oldpwd:[{required:!0,message:"请输入密码",trigger:"blur"}],newpwd:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:function(t,a,r){a!==e.form.oldpwd?r(new Error("两次输入密码不一致!")):r()},trigger:"blur"}],phone:[{required:!0,message:"请输入电话",trigger:"blur"},{validator:function(e,t,a){/^(13[0-9]{9})|(15[0-9][0-9]{8})|(18[0-9][0-9]{8})$/.test(t)?a():a(new Error("电话号码不合法"))},trigger:"blur"}]}}},created:function(){this.captcha=Math.floor(8999*Math.random()+1e3),console.log(this.captcha)},methods:{sendCaptcha:function(e){var t=this;return s()(o.a.mark(function a(){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$http.post("/gateway/shiro/sendCaptcha",e);case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},a,t)}))()},send:function(){var e=this;if(""!=this.form.phone&&null!=this.form.phone){/^(13[0-9]{9})|(15[0-9][0-9]{8})|(18[0-9][0-9]{8})$/.test(this.form.phone)?this.sendCaptcha({head:{version:"1",businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{phone:this.form.phone}}}).then(function(t){"success"==t.head.responseCode?(e.captcha=t.body.data,e.disableFlag=!0,e.dataRefreh(),console.log(e.captcha)):e.$message.error(t.head.message)}):alert("请输入正确格式的手机号!")}else alert("请输入手机号!")},dataRefreh:function(){var e=this;null==this.intervalId&&(this.intervalId=setTimeout(function(){e.captcha="",e.disableFlag=!1},3e5))},onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(e){if(t.loading=!0,t.captcha!=t.form.captcha)return alert("验证码错误!"),void(t.loading=!1);t.$http.post("/gateway/shiro/forgetPass",{head:{version:"1",businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{phone:t.form.phone,password:t.form.newpwd}}}).then(function(e){console.log(e),"success"==e.head.responseCode?(alert("重置密码成功!"),t.$router.push({path:"/Login",name:"Login",params:{}})):(alert(e.head.message),t.loading=!1)},function(e){console.log(e),this.loading=!1})}else alert("数据填写错误,请检查!")})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"register-body"},[a("div",{attrs:{slot:"header"},slot:"header"},[e._v("\n    重置密码\n  ")]),e._v(" "),a("div",{staticClass:"left-body"},[a("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"新密码",prop:"oldpwd"}},[a("el-input",{attrs:{"show-password":"",placeholder:"请输入密码"},model:{value:e.form.oldpwd,callback:function(t){e.$set(e.form,"oldpwd",t)},expression:"form.oldpwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"newpwd"}},[a("el-input",{attrs:{"show-password":"",placeholder:"请再次输入密码，需一致"},model:{value:e.form.newpwd,callback:function(t){e.$set(e.form,"newpwd",t)},expression:"form.newpwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"电话",prop:"phone"}},[a("el-input",{staticStyle:{width:"75%"},attrs:{placeholder:"请输入电话"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}}),e._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",disabled:e.disableFlag},on:{click:function(t){return e.send()}}},[e._v("发送验证码")])],1),e._v(" "),a("el-form-item",{attrs:{prop:"captcha"}},[a("el-input",{attrs:{name:"captcha",type:"text",placeholder:"验证码"},model:{value:e.form.captcha,callback:function(t){e.$set(e.form,"captcha",t)},expression:"form.captcha"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("确认修改")]),e._v(" "),a("el-button",{on:{click:function(e){return this.$router.push({path:"/Login",name:"Login"})}}},[e._v("取消")])],1)],1)],1)])},staticRenderFns:[]};var c=a("VU/8")(i,l,!1,function(e){a("HFOb")},"data-v-2e6e3e0d",null);t.default=c.exports},HFOb:function(e,t){}});