webpackJsonp([20],{LXxh:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={components:{},created:function(){this.reflashAll()},data:function(){return{menuVisible:!1,treeItem:{},rules:{name:[{required:!0,message:"请输入题目类别名称",trigger:"blur"},{min:2,max:100,message:"长度在 2 到 100 个字符",trigger:"blur"}],parentId:[{required:!0,message:"请选择题目类型",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},tableData:[{id:"001",name:"367201090252001280",parentId:"000",remark:"测试",createdBy:"Tom",createdTime:"2016-05-02",updatedBy:"Tom",updatedTime:"2016-05-02",status:"是"},{id:"002",name:"spring",parentId:"000",remark:"测试",updatedTime:"2016-05-02",status:"否"}],treeData:[{id:"1",label:"一级 1",parentId:"",status:"",version:"",children:[{id:"1",label:"二级 1-1",parentId:"",status:"",version:"",children:[{id:"1",label:"二级 1-1",parentId:"",status:"",version:""}]}]}],defaultProps:{children:"children",label:"name"},currentPage1:1,currentPage2:2,currentPage3:3,currentPage4:4,pageSize:10,pageIndex:0,total:10,formInline:{searchs:""},options:[{value:"0",label:"一级类别"}],value:"",addVisible:!1,addForm:{id:"1",name:"",parentId:"367201090252001280",status:"是",remark:"",version:"1"},editVisible:!1,editForm:{id:"",name:"",parentId:"",status:"",remark:"",version:"1"},multipleSelection:[],deleteTable:[{id:"",version:""}]}},methods:{rightClick:function(e,t,a,i){this.menuVisible=!1,this.menuVisible=!0;e.target.getBoundingClientRect();var o=document.querySelector("#menu");document.addEventListener("click",this.foo),o.style.left=e.pageX+"px",o.style.top=e.pageY-10+"px",console.log("右键被点击的event:",e.target.getBoundingClientRect()),console.log("右键被点击的object:",t),this.treeItem=t,console.log("this.treeItem"),console.log(this.treeItem),console.log(o)},foo:function(){this.menuVisible=!1,document.removeEventListener("click",this.foo)},menuUpdate:function(e,t){console.log("parentId:"+t.parentId),this.editForm.id=t.id,this.editForm.parentId=t.parentId,this.editForm.name=t.label,this.editForm.status=1==t.status?"是":"否",this.editForm.remark=t.remark,this.editForm.version=t.version,this.editVisible=!0,console.log(this.editForm)},reflashAll:function(){this.getData(),this.getOptions(),this.reflashTree()},getCookie:function(){if(document.cookie.length>0)for(var e=document.cookie.split("; "),t=0;t<e.length;t++){var a=e[t].split("=");if("staffToken"==a[0])return a[1]}else alert("登录超时!"),this.$router.push({path:"/Login",name:"Login",params:{}})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.handleAdd()})},editSubmitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.handleEdit()})},getData:function(){var e=this;console.log(this.formInline.serchs);var t={head:{version:"1",token:this.getCookie(),businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{name:this.formInline.searchs,pageIndex:this.pageIndex,pageSize:this.pageSize}}};this.$http.post("/gateway/basedata/category/queryPage",t).then(function(t){console.log(t),e.tableData=[];for(var a=t.body.data,i=0;i<a.length;i++)e.tableData[i]=a[i],e.tableData[i].status=1==e.tableData[i].status?"是":"否";console.log("分页查询成功"+t.body.data)},function(){console.log("error"),console.log("分页查询失败")})},handleNodeClick:function(e){var t=this;console.log(e.id),this.$http.post("/gateway/basedata/category/queryChildren",{head:{version:"1",token:this.getCookie(),businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{id:e.id}}}).then(function(e){t.tableData=[];for(var a=e.body.data,i=0;i<a.length;i++)t.tableData[i]=a[i],t.tableData[i].status=1==t.tableData[i].status?"是":"否";console.log("childrenTree查询成功"+a)},function(){console.log("error"),console.log("childrenTree查询失败")})},reflashTree:function(){var e=this;this.$http.post("/gateway/basedata/category/queryTree",{head:{version:"1",token:this.getCookie(),businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{parentId:"0"}}}).then(function(t){console.log(t);var a=t.body.data;console.log("Tree查询成功"+a),e.treeData=a},function(){console.log("error"),console.log("Tree查询失败")})},getOptions:function(){var e=this;this.$http.post("/gateway/basedata/category/queryOptions",{head:{version:"1",token:this.getCookie(),businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{parentId:"0"}}}).then(function(t){var a=t.body.data;console.log("Options查询成功:"),console.log(a),e.options=a,e.total=a.length-1},function(){console.log("error"),console.log("Options查询失败")})},addClick:function(e,t){this.addVisible=!0,this.addForm.parentId=t.id},handleAdd:function(){var e=this;this.$ajax.post("/gateway/basedata/category/add",{head:{version:"1",token:this.getCookie(),businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{id:"1",parentId:this.addForm.parentId,name:this.addForm.name,status:"是"==this.addForm.status?1:0,remark:this.addForm.remark,version:"1"}}}).then(function(t){console.log(t),alert(t.data.head.message),e.reflashAll()},function(){console.log("error"),alert("增加失败,内部原因")}),this.addVisible=!1},editClick:function(e,t){console.log("parentId:"+t.parentId),this.editForm.id=t.id,this.editForm.parentId=t.parentId,this.editForm.name=t.name,this.editForm.status=t.status,this.editForm.remark=t.remark,this.editForm.version=t.version,this.editVisible=!0,console.log(this.editForm)},handleEdit:function(){var e=this;this.$http.post("/gateway/basedata/category/update",{head:{version:"1",token:this.getCookie(),businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{id:this.editForm.id,parentId:this.editForm.parentId,name:this.editForm.name,status:"是"==this.editForm.status?1:0,remark:this.editForm.remark,version:this.editForm.version}}}).then(function(t){console.log(t),alert(t.head.message),e.reflashAll()},function(){console.log("error"),alert("修改失败,内部原因"),console.log("修改失败,内部原因")}),this.editVisible=!1},handleDelete:function(e,t){var a=this;console.log(t.id+"\n"+t.version),"否"==t.status||0==t.status?this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$message({type:"success",message:"执行删除!"}),a.tableData.splice(e,1)}).then(function(){a.$ajax.post("/gateway/basedata/category/delete",{head:{version:"1",token:a.getCookie(),businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{id:t.id,version:t.version}}}).then(function(e){console.log(e),alert(e.data.head.message),a.reflashAll()},function(){console.log("error"),alert("删除失败,该类别已被引用，无法删除"),this.reflashAll()})}).catch(function(){a.$message({type:"info",message:"已取消删除"})}):alert("该题目类别正在启用状态,不能删除!")},filterTag:function(e,t){return t.status===e},handleSizeChange:function(e){console.log("每页 "+e+" 条"),this.pageSize=e,this.reflashAll()},handleCurrentChange:function(e){console.log("当前页: "+e),this.pageIndex=e,this.reflashAll()},toggleSelection:function(e){var t=this;e?e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(e){this.multipleSelection=e,this.deleteTable=[];for(var t=0;t<e.length;t++){var a={};a.id=e[t].id,a.version=e[t].version,this.deleteTable.push(a)}console.log("选中的deletetable"),console.log(this.deleteTable)},updateSelected:function(){if(0==this.multipleSelection.length)alert("请勾选要修改的数据");else if(this.multipleSelection.length>1)alert("只能修改一个数据");else{var e=this.multipleSelection[0];console.log("parentId:"+e.parentId),this.editVisible=!0,this.editForm.id=e.id,this.editForm.parentId=e.parentId,this.editForm.name=e.name,this.editForm.status=e.status,this.editForm.remark=e.remark,this.editForm.version=e.version,console.log(this.editForm)}},deleteSelected:function(){var e=this;if(0==this.multipleSelection.length)alert("请勾选要删除的数据");else{for(var t=!0,a=0;a<this.multipleSelection.length;a++)"是"==this.multipleSelection[a].status&&t&&(t=!1,alert("选中的第"+(a+1)+"个题目类别启动状态，不能删除："+this.multipleSelection[a].name));t&&this.multipleSelection.length>0&&(console.log("将执行删除："),console.log(this.multipleSelection),this.$confirm("此操作将永久删除选中的文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$message({type:"success",message:"开始执行批量删除!"})}).then(function(){e.$ajax.post("/gateway/basedata/category/deleteSelected",{head:{version:"1",token:e.getCookie(),businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{deleteVOList:e.deleteTable}}}).then(function(t){console.log(t),alert(t.data.head.message),e.reflashAll()},function(){console.log("error"),alert("删除失败")})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}))}},handleCancel:function(){this.$emit("getCancel")},handleCloseBindWarnStandard:function(){this.$emit("closeBindWarnStandard")}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-container",{staticStyle:{height:"800px",border:"1px solid #eee"}},[a("el-aside",{staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"200px"}},[a("div",[a("el-header",{staticStyle:{margin:"20px 0px 20px 0px"}},[a("el-row",[a("h1",{staticStyle:{"font-size":"15px","text-align":"center","line-height":"50px"}},[e._v("题目类别管理")])]),e._v(" "),a("div",{staticClass:"horizon"},[a("hr")])],1),e._v(" "),a("el-tree",{attrs:{data:e.treeData,"node-key":"id"},on:{"node-contextmenu":e.rightClick,"node-click":e.handleNodeClick}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.menuVisible,expression:"menuVisible"}]},[a("el-card",[a("ul",{staticClass:"menu",attrs:{id:"menu",model:e.treeItem}},[a("li",{staticClass:"menu__item",on:{click:function(t){return e.addClick(1,e.treeItem)}}},[e._v("添加")]),e._v(" "),a("li",{staticClass:"menu__item",on:{click:function(t){return e.menuUpdate(1,e.treeItem)}}},[e._v("修改")]),e._v(" "),a("li",{staticClass:"menu__item",on:{click:function(t){return e.handleDelete(1,e.treeItem)}}},[e._v("删除")])])])],1)],1)]),e._v(" "),a("el-main",[a("div",{attrs:{id:"serchs"}},[a("el-form",{attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"题目类别"}},[a("el-input",{attrs:{placeholder:"请输入题目类别"},model:{value:e.formInline.searchs,callback:function(t){e.$set(e.formInline,"searchs",t)},expression:"formInline.searchs"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.reflashAll}},[e._v("查询")])],1)],1)],1),e._v(" "),a("div",{attrs:{id:"icon"}},[a("font",{attrs:{color:"#409EFF"},on:{click:function(t){e.addVisible=!0}}},[a("i",{staticClass:"el-icon-plus"},[e._v("增加")])]),e._v("\n           \n        "),a("font",{attrs:{color:"#E6A23C"},on:{click:function(t){return e.updateSelected()}}},[a("i",{staticClass:"el-icon-delete"},[e._v("修改")])]),e._v("\n           \n        "),a("font",{attrs:{color:"#F56C6C"},on:{click:function(t){return e.deleteSelected()}}},[a("i",{staticClass:"el-icon-edit"},[e._v("删除")])]),e._v("\n          \n         "),a("font",{attrs:{color:"#409EFF"}},[a("i",[e._v("已选中："+e._s(this.multipleSelection.length)+" ")])])],1),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"200%"},attrs:{stripe:"",data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"类别名称",width:"300"}}),e._v(" "),e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{prop:"updatedTime",label:"更新时间",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"是否启用",width:"180",filters:[{text:"是",value:"是"},{text:"否",value:"否"}],"filter-method":e.filterTag,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"是"===t.row.status?"success":"danger",effect:"dark","disable-transitions":""}},[e._v(e._s(t.row.status))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"360"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"big",type:"primary"},on:{click:function(a){return e.addClick(t.$index,t.row)}}},[e._v("增加")]),e._v(" "),a("el-button",{attrs:{size:"big",type:"warning"},on:{click:function(a){return e.editClick(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"big",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"page"},[a("span",{staticClass:"demonstration"},[e._v("完整功能")]),e._v(" "),a("el-pagination",{attrs:{"current-page":e.currentPage1,"page-sizes":[5,10,15,20],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:this.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加题目类别",visible:e.addVisible},on:{"update:visible":function(t){e.addVisible=t}}},[a("el-form",{ref:"addForm",staticClass:"demo-ruleForm",attrs:{rules:e.rules,model:e.addForm,size:"big","label-width":"100px"}},[a("el-row",[a("el-form-item",{attrs:{label:"父类别名称：",prop:"parentId"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addForm.parentId,callback:function(t){e.$set(e.addForm,"parentId",t)},expression:"addForm.parentId"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"类别名称：",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入类别名称"},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"status"}},[a("el-radio-group",{model:{value:e.addForm.status,callback:function(t){e.$set(e.addForm,"status",t)},expression:"addForm.status"}},[a("el-radio",{attrs:{label:"是",value:"是"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:"否",value:"否"}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注："}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:4}},model:{value:e.addForm.remark,callback:function(t){e.$set(e.addForm,"remark",t)},expression:"addForm.remark"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("addForm")}}},[e._v("确定添加")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改题目类别",visible:e.editVisible},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"editForm",staticClass:"demo-ruleForm",attrs:{rules:e.rules,model:e.editForm,size:"big","label-width":"100px"}},[a("el-row",[a("el-form-item",{attrs:{label:"父类别名称：",prop:"parentId"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editForm.parentId,callback:function(t){e.$set(e.editForm,"parentId",t)},expression:"editForm.parentId"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"类别名称：",prop:"name"}},[a("el-input",{model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"status"}},[a("el-radio-group",{model:{value:e.editForm.status,callback:function(t){e.$set(e.editForm,"status",t)},expression:"editForm.status"}},[a("el-radio",{attrs:{label:"是",value:"是"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:"否",value:"否"}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注："}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:4}},model:{value:e.editForm.remark,callback:function(t){e.$set(e.editForm,"remark",t)},expression:"editForm.remark"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editSubmitForm("editForm")}}},[e._v("确定修改")])],1)],1)],1)},staticRenderFns:[]};var n=a("VU/8")(i,o,!1,function(e){a("S4BR")},"data-v-f74a2204",null);t.default=n.exports},S4BR:function(e,t){}});