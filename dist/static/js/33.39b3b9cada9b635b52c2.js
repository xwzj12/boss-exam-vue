webpackJsonp([33],{"M4x+":function(e,t){},zbOk:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,l=a("bOdI"),o=a.n(l),s={components:{},created:function(){localStorage.setItem("Authorization","eyJhbGciOiJIUzI1NiJ9.eyJjb21wYW55SWQiOiIxMDEwMDEiLCJjb21wYW55TmFtZSI6IuWNmuaAnemVv-S5kOWIhuWFrOWPuCIsImlzcyI6Im1vb2NfdXNlciIsIm5hbWUiOiLlvKDkuIkiLCJleHAiOjE1ODkyNTI0NzcsInVzZXJJZCI6IjAwMSIsIm9yZ0lkIjoiMTAxIn0.hegrr4Ia9XtDzCCXv0CvpPyRFrC2LgoQZc3jdwmmsXA"),this.reflashAll()},data:function(){return{serchs:"",rules:{subjectName:[{required:!0,message:"请输入题目类型名称",trigger:"blur"},{min:2,max:100,message:"长度在 2 到 100 个字符",trigger:"blur"}],attribute:[{required:!0,message:"请选择题目类型",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},multipleSelection:[],deleteTable:[{id:"",version:""}],tableData:[{id:"001",subjectName:"多选题",attribute:"填空题",remark:"测试",updatedTime:"2016-05-02",status:"1",version:"1"},{id:"001",subjectName:"多选题",attribute:"填空题",remark:"测试",updatedTime:"2016-05-02",status:"1",version:"1"}],currentPage1:5,currentPage2:5,currentPage3:5,currentPage4:4,pageSize:5,pageIndex:0,total:5,formInline:{searchs:""},options:[{value:"单选题",label:"单选题"},{value:"多选题",label:"多选题"},{value:"主观题",label:"主观题"},{value:"填空题",label:"填空题"},{value:"判断题",label:"判断题"}],value:"",addVisible:!1,addForm:{subjectName:"单选题",attribute:"单选题",status:"是",remark:"测试"},editVisible:!1,editForm:{id:"001",subjectName:"多选题",attribute:"填空题",remark:"测试",updatedTime:"2016-05-02",status:"1",version:"1"}}},methods:(i={reflashAll:function(){this.getData(),this.queryTotal()},getCookie:function(){if(document.cookie.length>0)for(var e=document.cookie.split("; "),t=0;t<e.length;t++){var a=e[t].split("=");if("staffToken"==a[0])return a[1]}else alert("登录超时!"),this.$router.push({path:"/Login",name:"Login",params:{}})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.handleAdd()})},editSubmitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.handleEdit()})},getData:function(){var e=this;console.log(this.formInline.serchs),this.$ajax.post("/gateway/basedata/type/queryPage",{head:{version:"1",token:this.getCookie(),businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{name:this.formInline.searchs,pageIndex:this.pageIndex,pageSize:this.pageSize}}}).then(function(t){console.log(t),e.tableData=[];for(var a=t.data.body.data,i=0;i<a.length;i++)e.tableData[i]=a[i],e.tableData[i].status=1==e.tableData[i].status?"是":"否",console.log(e.tableData[i].status);console.log("分页查询成功"+t.data.body.data)},function(){console.log("error"),console.log("分页查询失败")})},queryTotal:function(){var e=this;this.$ajax.post("/gateway/basedata/type/queryTotal",{head:{version:"1",token:this.getCookie(),businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{name:this.formInline.searchs}}}).then(function(t){var a=t.data.body.data;console.log("查询total成功"+a),e.total=a},function(){console.log("error"),console.log("total查询失败")})},handleAdd:function(){var e=this;this.$ajax.post("/gateway/basedata/type/add",{head:{version:"1",token:this.getCookie(),businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{id:"1",subjectName:this.addForm.subjectName,status:"是"==this.addForm.status?1:0,remark:this.addForm.remark,attribute:this.addForm.attribute,version:"1"}}}).then(function(t){console.log(t);var a=t.data.head.message;alert(a),e.reflashAll()},function(){console.log("error"),alert("增加失败,内部错误")}),this.addVisible=!1},editClick:function(e,t){console.log(e,t),this.editVisible=!0,this.editForm.id=t.id,this.editForm.subjectName=t.subjectName,this.editForm.attribute=t.attribute,this.editForm.status=t.status,this.editForm.remark=t.remark,this.editForm.version=t.version},handleEdit:function(){var e=this;this.$ajax.post("/gateway/basedata/type/update",{head:{version:"1",token:this.getCookie(),businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{id:this.editForm.id,subjectName:this.editForm.subjectName,status:"是"==this.editForm.status?1:0,remark:this.editForm.remark,attribute:this.editForm.attribute,version:this.editForm.version}}}).then(function(t){console.log(t);var a=t.data.head.message;alert(a),e.reflashAll()},function(){console.log("error"),alert("修改失败,版本号不一致,请刷新重试 ")}),this.editVisible=!1},handleDelete:function(e,t){var a=this;console.log(t.id+"\n"+t.version),"否"==t.status?this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$message({type:"success",message:"执行删除!"}),a.tableData.splice(e,1)}).then(function(){a.$ajax.post("/gateway/basedata/type/delete",{head:{version:"1",token:a.getCookie(),businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{id:t.id,version:t.version}}}).then(function(e){console.log(e);var t=e.data.head.message;alert(t),a.reflashAll()},function(){console.log("error"),alert("删除失败,版本号不一致或该类型已被引用,请刷新重试")})}).catch(function(){a.$message({type:"info",message:"已取消删除"})}):alert("该题目类型正在启用状态,不能删除!")},filterTag:function(e,t){return t.status===e},handleSizeChange:function(e){console.log("每页 "+e+" 条"),this.pageSize=e,this.reflashAll()},handleCurrentChange:function(e){console.log("当前页: "+e),this.pageIndex=e,this.reflashAll()},handleSelectionChange:function(e){this.multipleSelection=e},toggleSelection:function(e){var t=this;e?e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection()}},o()(i,"handleSelectionChange",function(e){this.multipleSelection=e,this.deleteTable=[];for(var t=0;t<e.length;t++){var a={};a.id=e[t].id,a.version=e[t].version,this.deleteTable.push(a)}console.log("选中的deletetable"),console.log(this.deleteTable)}),o()(i,"updateSelected",function(){if(0==this.multipleSelection.length)alert("请勾选要修改的数据");else if(this.multipleSelection.length>1)alert("只能修改一个数据");else{var e=this.multipleSelection[0];this.editVisible=!0,this.editForm.id=e.id,this.editForm.subjectName=e.subjectName,this.editForm.attribute=e.attribute,this.editForm.status=e.status,this.editForm.remark=e.remark,this.editForm.version=e.version}}),o()(i,"deleteSelected",function(){var e=this;if(0==this.multipleSelection.length)alert("请勾选要删除的数据");else{for(var t=!0,a=0;a<this.multipleSelection.length;a++)"是"==this.multipleSelection[a].status&&t&&(t=!1,alert("选中的第"+(a+1)+"个题型启动状态，不能删除："+this.multipleSelection[a].subjectName));t&&this.multipleSelection.length>0&&(console.log("将执行删除："),console.log(this.multipleSelection),this.$confirm("此操作将永久删除选中的文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$message({type:"success",message:"开始执行批量删除!"})}).then(function(){e.$ajax.post("/gateway/basedata/type/deleteSelected",{head:{version:"1",token:e.getCookie(),businessType:"12",equipId:"1",equipType:1,encrypt:1},body:{data:{deleteVOList:e.deleteTable}}}).then(function(t){console.log(t);t.data.body.data;alert(t.data.head.message),e.reflashAll()},function(){console.log("error"),alert("删除失败")})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}))}}),o()(i,"handleCancel",function(){this.$emit("getCancel")}),o()(i,"handleCloseBindWarnStandard",function(){this.$emit("closeBindWarnStandard")}),i)},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-container",{staticStyle:{height:"700px",border:"1px solid #eee"}},[a("el-main",[a("div",{attrs:{id:"serchs"}},[a("el-form",{attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"题目类型"}},[a("el-input",{attrs:{placeholder:"请输入关键字"},model:{value:e.formInline.searchs,callback:function(t){e.$set(e.formInline,"searchs",t)},expression:"formInline.searchs"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.reflashAll}},[e._v("查询")])],1)],1)],1),e._v(" "),a("div",{attrs:{id:"icon"}},[a("font",{attrs:{color:"#409EFF"},on:{click:function(t){e.addVisible=!0}}},[a("i",{staticClass:"el-icon-plus"},[e._v("增加")])]),e._v("\n           \n        "),a("font",{attrs:{color:"#E6A23C"},on:{click:function(t){return e.updateSelected()}}},[a("i",{staticClass:"el-icon-delete"},[e._v("修改")])]),e._v("\n           \n        "),a("font",{attrs:{color:"#F56C6C"},on:{click:function(t){return e.deleteSelected()}}},[a("i",{staticClass:"el-icon-edit"},[e._v("删除")])]),e._v("\n            \n         "),a("font",{attrs:{color:"#409EFF"}},[a("i",[e._v("已选中："+e._s(this.multipleSelection.length)+" ")])])],1),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{stripe:"",data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"subjectName",label:"题目类型",width:"250"}}),e._v(" "),a("el-table-column",{attrs:{prop:"attribute",label:"属性",width:"250"}}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注",width:"250"}}),e._v(" "),a("el-table-column",{attrs:{prop:"updatedTime",label:"更新时间",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"180",filters:[{text:"是",value:"是"},{text:"否",value:"否"}],"filter-method":e.filterTag,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"是"===t.row.status?"success":"danger",effect:"dark","disable-transitions":""}},[e._v(e._s(t.row.status))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"360"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"big",type:"primary"},on:{click:function(t){e.addVisible=!0}}},[e._v("增加")]),e._v(" "),a("el-button",{attrs:{size:"big",type:"warning"},on:{click:function(a){return e.editClick(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"big",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"page"},[a("span",{staticClass:"demonstration"},[e._v("完整功能")]),e._v(" "),a("el-pagination",{attrs:{"current-page":0,"page-sizes":[2,5,10,20],"page-size":5,layout:"total, sizes, prev, pager, next, jumper",total:this.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加题型",visible:e.addVisible},on:{"update:visible":function(t){e.addVisible=t}}},[a("el-form",{ref:"addForm",staticClass:"demo-ruleForm",attrs:{rules:e.rules,model:e.addForm,size:"big","label-width":"100px"}},[a("el-row",[a("el-form-item",{attrs:{label:"题目类型：",prop:"subjectName"}},[a("el-input",{model:{value:e.addForm.subjectName,callback:function(t){e.$set(e.addForm,"subjectName",t)},expression:"addForm.subjectName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"属性：",prop:"attribute"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addForm.attribute,callback:function(t){e.$set(e.addForm,"attribute",t)},expression:"addForm.attribute"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"status"}},[a("el-radio-group",{model:{value:e.addForm.status,callback:function(t){e.$set(e.addForm,"status",t)},expression:"addForm.status"}},[a("el-radio",{attrs:{label:"是",value:"是"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:"否",value:"否"}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注："}},[a("el-input",{model:{value:e.addForm.remark,callback:function(t){e.$set(e.addForm,"remark",t)},expression:"addForm.remark"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("addForm")}}},[e._v("添加题目类型")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改题目类别",visible:e.editVisible},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"editForm",staticClass:"demo-ruleForm",attrs:{rules:e.rules,model:e.editForm,size:"big","label-width":"100px"}},[a("el-row",[a("el-form-item",{attrs:{label:"题目类型：",prop:"subjectName"}},[a("el-input",{model:{value:e.editForm.subjectName,callback:function(t){e.$set(e.editForm,"subjectName",t)},expression:"editForm.subjectName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"属性：",prop:"attribute"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editForm.attribute,callback:function(t){e.$set(e.editForm,"attribute",t)},expression:"editForm.attribute"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"status"}},[a("el-radio-group",{model:{value:e.editForm.status,callback:function(t){e.$set(e.editForm,"status",t)},expression:"editForm.status"}},[a("el-radio",{attrs:{label:"是",value:"是"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:"否",value:"否"}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注："}},[a("el-input",{model:{value:e.editForm.remark,callback:function(t){e.$set(e.editForm,"remark",t)},expression:"editForm.remark"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editSubmitForm("editForm")}}},[e._v("确定修改")])],1)],1)],1)},staticRenderFns:[]};var n=a("VU/8")(s,r,!1,function(e){a("M4x+")},null,null);t.default=n.exports}});